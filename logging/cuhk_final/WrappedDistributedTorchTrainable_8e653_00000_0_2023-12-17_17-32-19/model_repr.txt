SeqNeXt(
  (gfn): GalleryFilterNetwork(
    (query_roi_pool): MultiScaleRoIAlign(featmap_names=['feat_res4'], output_size=(14, 14), sampling_ratio=2)
    (query_reid_head): SwinHead(
      (head): Sequential(
        (0): permutei()
        (1): Sequential(
          (0): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.05217391304347826, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (1): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.06521739130434782, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (2): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.07826086956521738, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (3): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.09130434782608696, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (4): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.10434782608695652, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (5): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.11739130434782608, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (6): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.13043478260869565, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (7): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.14347826086956522, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (8): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.15652173913043477, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (9): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.16956521739130434, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (10): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.1826086956521739, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (11): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.1956521739130435, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (12): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.20869565217391303, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (13): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.2217391304347826, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (14): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.23478260869565215, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (15): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.24782608695652175, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (16): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.2608695652173913, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (17): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.27391304347826084, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
        )
        (2): PatchMerging(
          (reduction): Linear(in_features=1536, out_features=768, bias=False)
          (norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
        )
        (3): Sequential(
          (0): SwinTransformerBlock(
            (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=768, out_features=2304, bias=True)
              (proj): Linear(in_features=768, out_features=768, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.28695652173913044, mode=row)
            (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=768, out_features=3072, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=3072, out_features=768, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (1): SwinTransformerBlock(
            (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=768, out_features=2304, bias=True)
              (proj): Linear(in_features=768, out_features=768, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.3, mode=row)
            (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=768, out_features=3072, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=3072, out_features=768, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
        )
        (4): permuteo()
      )
    )
    (query_emb_head): NormAwareEmbedding(
      (projectors): ModuleDict(
        (feat_res4): Sequential(
          (0): Linear(in_features=384, out_features=1024, bias=True)
          (1): SafeBatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (feat_res5): Sequential(
          (0): Linear(in_features=768, out_features=1024, bias=True)
          (1): SafeBatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (rescaler): None
    )
    (head): SceneEmbeddingHead(
      (image_roi_pool): ScenePool()
      (image_reid_head): SwinHead(
        (head): Sequential(
          (0): permutei()
          (1): Sequential(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.05217391304347826, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.06521739130434782, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (2): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.07826086956521738, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (3): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.09130434782608696, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (4): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.10434782608695652, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (5): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.11739130434782608, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (6): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.13043478260869565, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (7): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.14347826086956522, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (8): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.15652173913043477, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (9): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.16956521739130434, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (10): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.1826086956521739, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (11): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.1956521739130435, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (12): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.20869565217391303, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (13): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.2217391304347826, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (14): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.23478260869565215, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (15): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.24782608695652175, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (16): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.2608695652173913, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (17): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.27391304347826084, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (2): PatchMerging(
            (reduction): Linear(in_features=1536, out_features=768, bias=False)
            (norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
          )
          (3): Sequential(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=768, out_features=2304, bias=True)
                (proj): Linear(in_features=768, out_features=768, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.28695652173913044, mode=row)
              (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=768, out_features=3072, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=3072, out_features=768, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=768, out_features=2304, bias=True)
                (proj): Linear(in_features=768, out_features=768, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.3, mode=row)
              (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=768, out_features=3072, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=3072, out_features=768, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (4): permuteo()
        )
      )
      (image_emb_head): NormAwareEmbedding(
        (projectors): ModuleDict(
          (feat_res4): Sequential(
            (0): Linear(in_features=384, out_features=1024, bias=True)
            (1): SafeBatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
          (feat_res5): Sequential(
            (0): Linear(in_features=768, out_features=1024, bias=True)
            (1): SafeBatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (rescaler): None
      )
    )
    (fuser): QueryImageFuser(
      (norm): BatchNorm1d(
        (norm): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (reid_loss): OIMLossSafe()
  )
  (backbone): SwinBackbone(
    (body): IntermediateLayerGetter(
      (0): Sequential(
        (0): Conv2d(3, 96, kernel_size=(4, 4), stride=(4, 4))
        (1): Permute()
        (2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (1): Sequential(
        (0): SwinTransformerBlock(
          (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (attn): ShiftedWindowAttention(
            (qkv): Linear(in_features=96, out_features=288, bias=True)
            (proj): Linear(in_features=96, out_features=96, bias=True)
          )
          (stochastic_depth): StochasticDepth(p=0.0, mode=row)
          (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (mlp): MLP(
            (0): Linear(in_features=96, out_features=384, bias=True)
            (1): GELU(approximate=none)
            (2): Dropout(p=0.0, inplace=False)
            (3): Linear(in_features=384, out_features=96, bias=True)
            (4): Dropout(p=0.0, inplace=False)
          )
        )
        (1): SwinTransformerBlock(
          (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (attn): ShiftedWindowAttention(
            (qkv): Linear(in_features=96, out_features=288, bias=True)
            (proj): Linear(in_features=96, out_features=96, bias=True)
          )
          (stochastic_depth): StochasticDepth(p=0.013043478260869565, mode=row)
          (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (mlp): MLP(
            (0): Linear(in_features=96, out_features=384, bias=True)
            (1): GELU(approximate=none)
            (2): Dropout(p=0.0, inplace=False)
            (3): Linear(in_features=384, out_features=96, bias=True)
            (4): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (2): PatchMerging(
        (reduction): Linear(in_features=384, out_features=192, bias=False)
        (norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
      )
      (3): Sequential(
        (0): SwinTransformerBlock(
          (norm1): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
          (attn): ShiftedWindowAttention(
            (qkv): Linear(in_features=192, out_features=576, bias=True)
            (proj): Linear(in_features=192, out_features=192, bias=True)
          )
          (stochastic_depth): StochasticDepth(p=0.02608695652173913, mode=row)
          (norm2): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
          (mlp): MLP(
            (0): Linear(in_features=192, out_features=768, bias=True)
            (1): GELU(approximate=none)
            (2): Dropout(p=0.0, inplace=False)
            (3): Linear(in_features=768, out_features=192, bias=True)
            (4): Dropout(p=0.0, inplace=False)
          )
        )
        (1): SwinTransformerBlock(
          (norm1): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
          (attn): ShiftedWindowAttention(
            (qkv): Linear(in_features=192, out_features=576, bias=True)
            (proj): Linear(in_features=192, out_features=192, bias=True)
          )
          (stochastic_depth): StochasticDepth(p=0.03913043478260869, mode=row)
          (norm2): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
          (mlp): MLP(
            (0): Linear(in_features=192, out_features=768, bias=True)
            (1): GELU(approximate=none)
            (2): Dropout(p=0.0, inplace=False)
            (3): Linear(in_features=768, out_features=192, bias=True)
            (4): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (4): PatchMerging(
        (reduction): Linear(in_features=768, out_features=384, bias=False)
        (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      )
      (5): Sequential(
        (0): SwinTransformerBlock(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): ShiftedWindowAttention(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (proj): Linear(in_features=384, out_features=384, bias=True)
          )
          (stochastic_depth): StochasticDepth(p=0.05217391304347826, mode=row)
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): MLP(
            (0): Linear(in_features=384, out_features=1536, bias=True)
            (1): GELU(approximate=none)
            (2): Dropout(p=0.0, inplace=False)
            (3): Linear(in_features=1536, out_features=384, bias=True)
            (4): Dropout(p=0.0, inplace=False)
          )
        )
        (1): SwinTransformerBlock(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): ShiftedWindowAttention(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (proj): Linear(in_features=384, out_features=384, bias=True)
          )
          (stochastic_depth): StochasticDepth(p=0.06521739130434782, mode=row)
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): MLP(
            (0): Linear(in_features=384, out_features=1536, bias=True)
            (1): GELU(approximate=none)
            (2): Dropout(p=0.0, inplace=False)
            (3): Linear(in_features=1536, out_features=384, bias=True)
            (4): Dropout(p=0.0, inplace=False)
          )
        )
        (2): SwinTransformerBlock(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): ShiftedWindowAttention(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (proj): Linear(in_features=384, out_features=384, bias=True)
          )
          (stochastic_depth): StochasticDepth(p=0.07826086956521738, mode=row)
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): MLP(
            (0): Linear(in_features=384, out_features=1536, bias=True)
            (1): GELU(approximate=none)
            (2): Dropout(p=0.0, inplace=False)
            (3): Linear(in_features=1536, out_features=384, bias=True)
            (4): Dropout(p=0.0, inplace=False)
          )
        )
        (3): SwinTransformerBlock(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): ShiftedWindowAttention(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (proj): Linear(in_features=384, out_features=384, bias=True)
          )
          (stochastic_depth): StochasticDepth(p=0.09130434782608696, mode=row)
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): MLP(
            (0): Linear(in_features=384, out_features=1536, bias=True)
            (1): GELU(approximate=none)
            (2): Dropout(p=0.0, inplace=False)
            (3): Linear(in_features=1536, out_features=384, bias=True)
            (4): Dropout(p=0.0, inplace=False)
          )
        )
        (4): SwinTransformerBlock(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): ShiftedWindowAttention(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (proj): Linear(in_features=384, out_features=384, bias=True)
          )
          (stochastic_depth): StochasticDepth(p=0.10434782608695652, mode=row)
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): MLP(
            (0): Linear(in_features=384, out_features=1536, bias=True)
            (1): GELU(approximate=none)
            (2): Dropout(p=0.0, inplace=False)
            (3): Linear(in_features=1536, out_features=384, bias=True)
            (4): Dropout(p=0.0, inplace=False)
          )
        )
        (5): SwinTransformerBlock(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): ShiftedWindowAttention(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (proj): Linear(in_features=384, out_features=384, bias=True)
          )
          (stochastic_depth): StochasticDepth(p=0.11739130434782608, mode=row)
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): MLP(
            (0): Linear(in_features=384, out_features=1536, bias=True)
            (1): GELU(approximate=none)
            (2): Dropout(p=0.0, inplace=False)
            (3): Linear(in_features=1536, out_features=384, bias=True)
            (4): Dropout(p=0.0, inplace=False)
          )
        )
        (6): SwinTransformerBlock(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): ShiftedWindowAttention(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (proj): Linear(in_features=384, out_features=384, bias=True)
          )
          (stochastic_depth): StochasticDepth(p=0.13043478260869565, mode=row)
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): MLP(
            (0): Linear(in_features=384, out_features=1536, bias=True)
            (1): GELU(approximate=none)
            (2): Dropout(p=0.0, inplace=False)
            (3): Linear(in_features=1536, out_features=384, bias=True)
            (4): Dropout(p=0.0, inplace=False)
          )
        )
        (7): SwinTransformerBlock(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): ShiftedWindowAttention(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (proj): Linear(in_features=384, out_features=384, bias=True)
          )
          (stochastic_depth): StochasticDepth(p=0.14347826086956522, mode=row)
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): MLP(
            (0): Linear(in_features=384, out_features=1536, bias=True)
            (1): GELU(approximate=none)
            (2): Dropout(p=0.0, inplace=False)
            (3): Linear(in_features=1536, out_features=384, bias=True)
            (4): Dropout(p=0.0, inplace=False)
          )
        )
        (8): SwinTransformerBlock(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): ShiftedWindowAttention(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (proj): Linear(in_features=384, out_features=384, bias=True)
          )
          (stochastic_depth): StochasticDepth(p=0.15652173913043477, mode=row)
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): MLP(
            (0): Linear(in_features=384, out_features=1536, bias=True)
            (1): GELU(approximate=none)
            (2): Dropout(p=0.0, inplace=False)
            (3): Linear(in_features=1536, out_features=384, bias=True)
            (4): Dropout(p=0.0, inplace=False)
          )
        )
        (9): SwinTransformerBlock(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): ShiftedWindowAttention(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (proj): Linear(in_features=384, out_features=384, bias=True)
          )
          (stochastic_depth): StochasticDepth(p=0.16956521739130434, mode=row)
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): MLP(
            (0): Linear(in_features=384, out_features=1536, bias=True)
            (1): GELU(approximate=none)
            (2): Dropout(p=0.0, inplace=False)
            (3): Linear(in_features=1536, out_features=384, bias=True)
            (4): Dropout(p=0.0, inplace=False)
          )
        )
        (10): SwinTransformerBlock(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): ShiftedWindowAttention(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (proj): Linear(in_features=384, out_features=384, bias=True)
          )
          (stochastic_depth): StochasticDepth(p=0.1826086956521739, mode=row)
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): MLP(
            (0): Linear(in_features=384, out_features=1536, bias=True)
            (1): GELU(approximate=none)
            (2): Dropout(p=0.0, inplace=False)
            (3): Linear(in_features=1536, out_features=384, bias=True)
            (4): Dropout(p=0.0, inplace=False)
          )
        )
        (11): SwinTransformerBlock(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): ShiftedWindowAttention(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (proj): Linear(in_features=384, out_features=384, bias=True)
          )
          (stochastic_depth): StochasticDepth(p=0.1956521739130435, mode=row)
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): MLP(
            (0): Linear(in_features=384, out_features=1536, bias=True)
            (1): GELU(approximate=none)
            (2): Dropout(p=0.0, inplace=False)
            (3): Linear(in_features=1536, out_features=384, bias=True)
            (4): Dropout(p=0.0, inplace=False)
          )
        )
        (12): SwinTransformerBlock(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): ShiftedWindowAttention(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (proj): Linear(in_features=384, out_features=384, bias=True)
          )
          (stochastic_depth): StochasticDepth(p=0.20869565217391303, mode=row)
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): MLP(
            (0): Linear(in_features=384, out_features=1536, bias=True)
            (1): GELU(approximate=none)
            (2): Dropout(p=0.0, inplace=False)
            (3): Linear(in_features=1536, out_features=384, bias=True)
            (4): Dropout(p=0.0, inplace=False)
          )
        )
        (13): SwinTransformerBlock(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): ShiftedWindowAttention(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (proj): Linear(in_features=384, out_features=384, bias=True)
          )
          (stochastic_depth): StochasticDepth(p=0.2217391304347826, mode=row)
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): MLP(
            (0): Linear(in_features=384, out_features=1536, bias=True)
            (1): GELU(approximate=none)
            (2): Dropout(p=0.0, inplace=False)
            (3): Linear(in_features=1536, out_features=384, bias=True)
            (4): Dropout(p=0.0, inplace=False)
          )
        )
        (14): SwinTransformerBlock(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): ShiftedWindowAttention(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (proj): Linear(in_features=384, out_features=384, bias=True)
          )
          (stochastic_depth): StochasticDepth(p=0.23478260869565215, mode=row)
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): MLP(
            (0): Linear(in_features=384, out_features=1536, bias=True)
            (1): GELU(approximate=none)
            (2): Dropout(p=0.0, inplace=False)
            (3): Linear(in_features=1536, out_features=384, bias=True)
            (4): Dropout(p=0.0, inplace=False)
          )
        )
        (15): SwinTransformerBlock(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): ShiftedWindowAttention(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (proj): Linear(in_features=384, out_features=384, bias=True)
          )
          (stochastic_depth): StochasticDepth(p=0.24782608695652175, mode=row)
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): MLP(
            (0): Linear(in_features=384, out_features=1536, bias=True)
            (1): GELU(approximate=none)
            (2): Dropout(p=0.0, inplace=False)
            (3): Linear(in_features=1536, out_features=384, bias=True)
            (4): Dropout(p=0.0, inplace=False)
          )
        )
        (16): SwinTransformerBlock(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): ShiftedWindowAttention(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (proj): Linear(in_features=384, out_features=384, bias=True)
          )
          (stochastic_depth): StochasticDepth(p=0.2608695652173913, mode=row)
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): MLP(
            (0): Linear(in_features=384, out_features=1536, bias=True)
            (1): GELU(approximate=none)
            (2): Dropout(p=0.0, inplace=False)
            (3): Linear(in_features=1536, out_features=384, bias=True)
            (4): Dropout(p=0.0, inplace=False)
          )
        )
        (17): SwinTransformerBlock(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): ShiftedWindowAttention(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (proj): Linear(in_features=384, out_features=384, bias=True)
          )
          (stochastic_depth): StochasticDepth(p=0.27391304347826084, mode=row)
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): MLP(
            (0): Linear(in_features=384, out_features=1536, bias=True)
            (1): GELU(approximate=none)
            (2): Dropout(p=0.0, inplace=False)
            (3): Linear(in_features=1536, out_features=384, bias=True)
            (4): Dropout(p=0.0, inplace=False)
          )
        )
      )
    )
  )
  (rpn): SafeRegionProposalNetwork(
    (anchor_generator): AnchorGenerator()
    (head): RPNHead(
      (conv): Sequential(
        (0): Conv2dNormActivation(
          (0): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (1): ReLU(inplace=True)
        )
      )
      (cls_logits): Conv2d(384, 15, kernel_size=(1, 1), stride=(1, 1))
      (bbox_pred): Conv2d(384, 60, kernel_size=(1, 1), stride=(1, 1))
    )
  )
  (roi_heads): SeqRoIHeads(
    (box_roi_pool): MultiScaleRoIAlign(featmap_names=['feat_res4'], output_size=(14, 14), sampling_ratio=2)
    (box_head): SwinHead(
      (head): Sequential(
        (0): permutei()
        (1): Sequential(
          (0): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.05217391304347826, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (1): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.06521739130434782, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (2): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.07826086956521738, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (3): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.09130434782608696, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (4): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.10434782608695652, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (5): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.11739130434782608, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (6): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.13043478260869565, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (7): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.14347826086956522, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (8): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.15652173913043477, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (9): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.16956521739130434, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (10): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.1826086956521739, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (11): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.1956521739130435, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (12): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.20869565217391303, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (13): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.2217391304347826, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (14): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.23478260869565215, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (15): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.24782608695652175, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (16): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.2608695652173913, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (17): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.27391304347826084, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
        )
        (2): PatchMerging(
          (reduction): Linear(in_features=1536, out_features=768, bias=False)
          (norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
        )
        (3): Sequential(
          (0): SwinTransformerBlock(
            (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=768, out_features=2304, bias=True)
              (proj): Linear(in_features=768, out_features=768, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.28695652173913044, mode=row)
            (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=768, out_features=3072, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=3072, out_features=768, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (1): SwinTransformerBlock(
            (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=768, out_features=2304, bias=True)
              (proj): Linear(in_features=768, out_features=768, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.3, mode=row)
            (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=768, out_features=3072, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=3072, out_features=768, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
        )
        (4): permuteo()
      )
    )
    (reid_loss): OIMLossSafe()
    (embedding_head): NormAwareEmbedding(
      (projectors): ModuleDict(
        (feat_res4): Sequential(
          (0): Linear(in_features=384, out_features=1024, bias=True)
          (1): SafeBatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (feat_res5): Sequential(
          (0): Linear(in_features=768, out_features=1024, bias=True)
          (1): SafeBatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (rescaler): None
    )
    (faster_rcnn_predictor): FastRCNNPredictor(
      (cls_score): Linear(in_features=768, out_features=2, bias=True)
      (bbox_pred): Linear(in_features=768, out_features=8, bias=True)
    )
    (reid_head): SwinHead(
      (head): Sequential(
        (0): permutei()
        (1): Sequential(
          (0): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.05217391304347826, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (1): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.06521739130434782, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (2): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.07826086956521738, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (3): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.09130434782608696, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (4): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.10434782608695652, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (5): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.11739130434782608, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (6): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.13043478260869565, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (7): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.14347826086956522, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (8): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.15652173913043477, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (9): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.16956521739130434, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (10): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.1826086956521739, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (11): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.1956521739130435, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (12): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.20869565217391303, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (13): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.2217391304347826, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (14): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.23478260869565215, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (15): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.24782608695652175, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (16): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.2608695652173913, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (17): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.27391304347826084, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
        )
        (2): PatchMerging(
          (reduction): Linear(in_features=1536, out_features=768, bias=False)
          (norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
        )
        (3): Sequential(
          (0): SwinTransformerBlock(
            (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=768, out_features=2304, bias=True)
              (proj): Linear(in_features=768, out_features=768, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.28695652173913044, mode=row)
            (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=768, out_features=3072, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=3072, out_features=768, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (1): SwinTransformerBlock(
            (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=768, out_features=2304, bias=True)
              (proj): Linear(in_features=768, out_features=768, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.3, mode=row)
            (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=768, out_features=3072, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=3072, out_features=768, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
        )
        (4): permuteo()
      )
    )
    (reid_roi_pool): MultiScaleRoIAlign(featmap_names=['feat_res4'], output_size=(14, 14), sampling_ratio=2)
    (prop_head): SwinHead(
      (head): Sequential(
        (0): permutei()
        (1): Sequential(
          (0): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.05217391304347826, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (1): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.06521739130434782, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (2): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.07826086956521738, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (3): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.09130434782608696, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (4): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.10434782608695652, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (5): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.11739130434782608, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (6): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.13043478260869565, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (7): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.14347826086956522, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (8): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.15652173913043477, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (9): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.16956521739130434, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (10): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.1826086956521739, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (11): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.1956521739130435, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (12): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.20869565217391303, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (13): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.2217391304347826, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (14): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.23478260869565215, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (15): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.24782608695652175, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (16): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.2608695652173913, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (17): SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.27391304347826084, mode=row)
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=384, out_features=1536, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=1536, out_features=384, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
        )
        (2): PatchMerging(
          (reduction): Linear(in_features=1536, out_features=768, bias=False)
          (norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
        )
        (3): Sequential(
          (0): SwinTransformerBlock(
            (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=768, out_features=2304, bias=True)
              (proj): Linear(in_features=768, out_features=768, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.28695652173913044, mode=row)
            (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=768, out_features=3072, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=3072, out_features=768, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
          (1): SwinTransformerBlock(
            (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (attn): ShiftedWindowAttention(
              (qkv): Linear(in_features=768, out_features=2304, bias=True)
              (proj): Linear(in_features=768, out_features=768, bias=True)
            )
            (stochastic_depth): StochasticDepth(p=0.3, mode=row)
            (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): MLP(
              (0): Linear(in_features=768, out_features=3072, bias=True)
              (1): GELU(approximate=none)
              (2): Dropout(p=0.0, inplace=False)
              (3): Linear(in_features=3072, out_features=768, bias=True)
              (4): Dropout(p=0.0, inplace=False)
            )
          )
        )
        (4): permuteo()
      )
    )
    (gfn): GalleryFilterNetwork(
      (query_roi_pool): MultiScaleRoIAlign(featmap_names=['feat_res4'], output_size=(14, 14), sampling_ratio=2)
      (query_reid_head): SwinHead(
        (head): Sequential(
          (0): permutei()
          (1): Sequential(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.05217391304347826, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.06521739130434782, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (2): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.07826086956521738, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (3): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.09130434782608696, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (4): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.10434782608695652, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (5): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.11739130434782608, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (6): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.13043478260869565, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (7): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.14347826086956522, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (8): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.15652173913043477, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (9): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.16956521739130434, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (10): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.1826086956521739, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (11): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.1956521739130435, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (12): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.20869565217391303, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (13): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.2217391304347826, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (14): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.23478260869565215, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (15): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.24782608695652175, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (16): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.2608695652173913, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (17): SwinTransformerBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=384, out_features=1152, bias=True)
                (proj): Linear(in_features=384, out_features=384, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.27391304347826084, mode=row)
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=384, out_features=1536, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=1536, out_features=384, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (2): PatchMerging(
            (reduction): Linear(in_features=1536, out_features=768, bias=False)
            (norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
          )
          (3): Sequential(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=768, out_features=2304, bias=True)
                (proj): Linear(in_features=768, out_features=768, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.28695652173913044, mode=row)
              (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=768, out_features=3072, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=3072, out_features=768, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftedWindowAttention(
                (qkv): Linear(in_features=768, out_features=2304, bias=True)
                (proj): Linear(in_features=768, out_features=768, bias=True)
              )
              (stochastic_depth): StochasticDepth(p=0.3, mode=row)
              (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
              (mlp): MLP(
                (0): Linear(in_features=768, out_features=3072, bias=True)
                (1): GELU(approximate=none)
                (2): Dropout(p=0.0, inplace=False)
                (3): Linear(in_features=3072, out_features=768, bias=True)
                (4): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (4): permuteo()
        )
      )
      (query_emb_head): NormAwareEmbedding(
        (projectors): ModuleDict(
          (feat_res4): Sequential(
            (0): Linear(in_features=384, out_features=1024, bias=True)
            (1): SafeBatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
          (feat_res5): Sequential(
            (0): Linear(in_features=768, out_features=1024, bias=True)
            (1): SafeBatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (rescaler): None
      )
      (head): SceneEmbeddingHead(
        (image_roi_pool): ScenePool()
        (image_reid_head): SwinHead(
          (head): Sequential(
            (0): permutei()
            (1): Sequential(
              (0): SwinTransformerBlock(
                (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (attn): ShiftedWindowAttention(
                  (qkv): Linear(in_features=384, out_features=1152, bias=True)
                  (proj): Linear(in_features=384, out_features=384, bias=True)
                )
                (stochastic_depth): StochasticDepth(p=0.05217391304347826, mode=row)
                (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (mlp): MLP(
                  (0): Linear(in_features=384, out_features=1536, bias=True)
                  (1): GELU(approximate=none)
                  (2): Dropout(p=0.0, inplace=False)
                  (3): Linear(in_features=1536, out_features=384, bias=True)
                  (4): Dropout(p=0.0, inplace=False)
                )
              )
              (1): SwinTransformerBlock(
                (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (attn): ShiftedWindowAttention(
                  (qkv): Linear(in_features=384, out_features=1152, bias=True)
                  (proj): Linear(in_features=384, out_features=384, bias=True)
                )
                (stochastic_depth): StochasticDepth(p=0.06521739130434782, mode=row)
                (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (mlp): MLP(
                  (0): Linear(in_features=384, out_features=1536, bias=True)
                  (1): GELU(approximate=none)
                  (2): Dropout(p=0.0, inplace=False)
                  (3): Linear(in_features=1536, out_features=384, bias=True)
                  (4): Dropout(p=0.0, inplace=False)
                )
              )
              (2): SwinTransformerBlock(
                (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (attn): ShiftedWindowAttention(
                  (qkv): Linear(in_features=384, out_features=1152, bias=True)
                  (proj): Linear(in_features=384, out_features=384, bias=True)
                )
                (stochastic_depth): StochasticDepth(p=0.07826086956521738, mode=row)
                (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (mlp): MLP(
                  (0): Linear(in_features=384, out_features=1536, bias=True)
                  (1): GELU(approximate=none)
                  (2): Dropout(p=0.0, inplace=False)
                  (3): Linear(in_features=1536, out_features=384, bias=True)
                  (4): Dropout(p=0.0, inplace=False)
                )
              )
              (3): SwinTransformerBlock(
                (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (attn): ShiftedWindowAttention(
                  (qkv): Linear(in_features=384, out_features=1152, bias=True)
                  (proj): Linear(in_features=384, out_features=384, bias=True)
                )
                (stochastic_depth): StochasticDepth(p=0.09130434782608696, mode=row)
                (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (mlp): MLP(
                  (0): Linear(in_features=384, out_features=1536, bias=True)
                  (1): GELU(approximate=none)
                  (2): Dropout(p=0.0, inplace=False)
                  (3): Linear(in_features=1536, out_features=384, bias=True)
                  (4): Dropout(p=0.0, inplace=False)
                )
              )
              (4): SwinTransformerBlock(
                (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (attn): ShiftedWindowAttention(
                  (qkv): Linear(in_features=384, out_features=1152, bias=True)
                  (proj): Linear(in_features=384, out_features=384, bias=True)
                )
                (stochastic_depth): StochasticDepth(p=0.10434782608695652, mode=row)
                (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (mlp): MLP(
                  (0): Linear(in_features=384, out_features=1536, bias=True)
                  (1): GELU(approximate=none)
                  (2): Dropout(p=0.0, inplace=False)
                  (3): Linear(in_features=1536, out_features=384, bias=True)
                  (4): Dropout(p=0.0, inplace=False)
                )
              )
              (5): SwinTransformerBlock(
                (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (attn): ShiftedWindowAttention(
                  (qkv): Linear(in_features=384, out_features=1152, bias=True)
                  (proj): Linear(in_features=384, out_features=384, bias=True)
                )
                (stochastic_depth): StochasticDepth(p=0.11739130434782608, mode=row)
                (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (mlp): MLP(
                  (0): Linear(in_features=384, out_features=1536, bias=True)
                  (1): GELU(approximate=none)
                  (2): Dropout(p=0.0, inplace=False)
                  (3): Linear(in_features=1536, out_features=384, bias=True)
                  (4): Dropout(p=0.0, inplace=False)
                )
              )
              (6): SwinTransformerBlock(
                (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (attn): ShiftedWindowAttention(
                  (qkv): Linear(in_features=384, out_features=1152, bias=True)
                  (proj): Linear(in_features=384, out_features=384, bias=True)
                )
                (stochastic_depth): StochasticDepth(p=0.13043478260869565, mode=row)
                (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (mlp): MLP(
                  (0): Linear(in_features=384, out_features=1536, bias=True)
                  (1): GELU(approximate=none)
                  (2): Dropout(p=0.0, inplace=False)
                  (3): Linear(in_features=1536, out_features=384, bias=True)
                  (4): Dropout(p=0.0, inplace=False)
                )
              )
              (7): SwinTransformerBlock(
                (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (attn): ShiftedWindowAttention(
                  (qkv): Linear(in_features=384, out_features=1152, bias=True)
                  (proj): Linear(in_features=384, out_features=384, bias=True)
                )
                (stochastic_depth): StochasticDepth(p=0.14347826086956522, mode=row)
                (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (mlp): MLP(
                  (0): Linear(in_features=384, out_features=1536, bias=True)
                  (1): GELU(approximate=none)
                  (2): Dropout(p=0.0, inplace=False)
                  (3): Linear(in_features=1536, out_features=384, bias=True)
                  (4): Dropout(p=0.0, inplace=False)
                )
              )
              (8): SwinTransformerBlock(
                (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (attn): ShiftedWindowAttention(
                  (qkv): Linear(in_features=384, out_features=1152, bias=True)
                  (proj): Linear(in_features=384, out_features=384, bias=True)
                )
                (stochastic_depth): StochasticDepth(p=0.15652173913043477, mode=row)
                (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (mlp): MLP(
                  (0): Linear(in_features=384, out_features=1536, bias=True)
                  (1): GELU(approximate=none)
                  (2): Dropout(p=0.0, inplace=False)
                  (3): Linear(in_features=1536, out_features=384, bias=True)
                  (4): Dropout(p=0.0, inplace=False)
                )
              )
              (9): SwinTransformerBlock(
                (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (attn): ShiftedWindowAttention(
                  (qkv): Linear(in_features=384, out_features=1152, bias=True)
                  (proj): Linear(in_features=384, out_features=384, bias=True)
                )
                (stochastic_depth): StochasticDepth(p=0.16956521739130434, mode=row)
                (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (mlp): MLP(
                  (0): Linear(in_features=384, out_features=1536, bias=True)
                  (1): GELU(approximate=none)
                  (2): Dropout(p=0.0, inplace=False)
                  (3): Linear(in_features=1536, out_features=384, bias=True)
                  (4): Dropout(p=0.0, inplace=False)
                )
              )
              (10): SwinTransformerBlock(
                (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (attn): ShiftedWindowAttention(
                  (qkv): Linear(in_features=384, out_features=1152, bias=True)
                  (proj): Linear(in_features=384, out_features=384, bias=True)
                )
                (stochastic_depth): StochasticDepth(p=0.1826086956521739, mode=row)
                (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (mlp): MLP(
                  (0): Linear(in_features=384, out_features=1536, bias=True)
                  (1): GELU(approximate=none)
                  (2): Dropout(p=0.0, inplace=False)
                  (3): Linear(in_features=1536, out_features=384, bias=True)
                  (4): Dropout(p=0.0, inplace=False)
                )
              )
              (11): SwinTransformerBlock(
                (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (attn): ShiftedWindowAttention(
                  (qkv): Linear(in_features=384, out_features=1152, bias=True)
                  (proj): Linear(in_features=384, out_features=384, bias=True)
                )
                (stochastic_depth): StochasticDepth(p=0.1956521739130435, mode=row)
                (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (mlp): MLP(
                  (0): Linear(in_features=384, out_features=1536, bias=True)
                  (1): GELU(approximate=none)
                  (2): Dropout(p=0.0, inplace=False)
                  (3): Linear(in_features=1536, out_features=384, bias=True)
                  (4): Dropout(p=0.0, inplace=False)
                )
              )
              (12): SwinTransformerBlock(
                (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (attn): ShiftedWindowAttention(
                  (qkv): Linear(in_features=384, out_features=1152, bias=True)
                  (proj): Linear(in_features=384, out_features=384, bias=True)
                )
                (stochastic_depth): StochasticDepth(p=0.20869565217391303, mode=row)
                (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (mlp): MLP(
                  (0): Linear(in_features=384, out_features=1536, bias=True)
                  (1): GELU(approximate=none)
                  (2): Dropout(p=0.0, inplace=False)
                  (3): Linear(in_features=1536, out_features=384, bias=True)
                  (4): Dropout(p=0.0, inplace=False)
                )
              )
              (13): SwinTransformerBlock(
                (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (attn): ShiftedWindowAttention(
                  (qkv): Linear(in_features=384, out_features=1152, bias=True)
                  (proj): Linear(in_features=384, out_features=384, bias=True)
                )
                (stochastic_depth): StochasticDepth(p=0.2217391304347826, mode=row)
                (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (mlp): MLP(
                  (0): Linear(in_features=384, out_features=1536, bias=True)
                  (1): GELU(approximate=none)
                  (2): Dropout(p=0.0, inplace=False)
                  (3): Linear(in_features=1536, out_features=384, bias=True)
                  (4): Dropout(p=0.0, inplace=False)
                )
              )
              (14): SwinTransformerBlock(
                (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (attn): ShiftedWindowAttention(
                  (qkv): Linear(in_features=384, out_features=1152, bias=True)
                  (proj): Linear(in_features=384, out_features=384, bias=True)
                )
                (stochastic_depth): StochasticDepth(p=0.23478260869565215, mode=row)
                (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (mlp): MLP(
                  (0): Linear(in_features=384, out_features=1536, bias=True)
                  (1): GELU(approximate=none)
                  (2): Dropout(p=0.0, inplace=False)
                  (3): Linear(in_features=1536, out_features=384, bias=True)
                  (4): Dropout(p=0.0, inplace=False)
                )
              )
              (15): SwinTransformerBlock(
                (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (attn): ShiftedWindowAttention(
                  (qkv): Linear(in_features=384, out_features=1152, bias=True)
                  (proj): Linear(in_features=384, out_features=384, bias=True)
                )
                (stochastic_depth): StochasticDepth(p=0.24782608695652175, mode=row)
                (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (mlp): MLP(
                  (0): Linear(in_features=384, out_features=1536, bias=True)
                  (1): GELU(approximate=none)
                  (2): Dropout(p=0.0, inplace=False)
                  (3): Linear(in_features=1536, out_features=384, bias=True)
                  (4): Dropout(p=0.0, inplace=False)
                )
              )
              (16): SwinTransformerBlock(
                (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (attn): ShiftedWindowAttention(
                  (qkv): Linear(in_features=384, out_features=1152, bias=True)
                  (proj): Linear(in_features=384, out_features=384, bias=True)
                )
                (stochastic_depth): StochasticDepth(p=0.2608695652173913, mode=row)
                (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (mlp): MLP(
                  (0): Linear(in_features=384, out_features=1536, bias=True)
                  (1): GELU(approximate=none)
                  (2): Dropout(p=0.0, inplace=False)
                  (3): Linear(in_features=1536, out_features=384, bias=True)
                  (4): Dropout(p=0.0, inplace=False)
                )
              )
              (17): SwinTransformerBlock(
                (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (attn): ShiftedWindowAttention(
                  (qkv): Linear(in_features=384, out_features=1152, bias=True)
                  (proj): Linear(in_features=384, out_features=384, bias=True)
                )
                (stochastic_depth): StochasticDepth(p=0.27391304347826084, mode=row)
                (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
                (mlp): MLP(
                  (0): Linear(in_features=384, out_features=1536, bias=True)
                  (1): GELU(approximate=none)
                  (2): Dropout(p=0.0, inplace=False)
                  (3): Linear(in_features=1536, out_features=384, bias=True)
                  (4): Dropout(p=0.0, inplace=False)
                )
              )
            )
            (2): PatchMerging(
              (reduction): Linear(in_features=1536, out_features=768, bias=False)
              (norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
            )
            (3): Sequential(
              (0): SwinTransformerBlock(
                (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (attn): ShiftedWindowAttention(
                  (qkv): Linear(in_features=768, out_features=2304, bias=True)
                  (proj): Linear(in_features=768, out_features=768, bias=True)
                )
                (stochastic_depth): StochasticDepth(p=0.28695652173913044, mode=row)
                (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (mlp): MLP(
                  (0): Linear(in_features=768, out_features=3072, bias=True)
                  (1): GELU(approximate=none)
                  (2): Dropout(p=0.0, inplace=False)
                  (3): Linear(in_features=3072, out_features=768, bias=True)
                  (4): Dropout(p=0.0, inplace=False)
                )
              )
              (1): SwinTransformerBlock(
                (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (attn): ShiftedWindowAttention(
                  (qkv): Linear(in_features=768, out_features=2304, bias=True)
                  (proj): Linear(in_features=768, out_features=768, bias=True)
                )
                (stochastic_depth): StochasticDepth(p=0.3, mode=row)
                (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (mlp): MLP(
                  (0): Linear(in_features=768, out_features=3072, bias=True)
                  (1): GELU(approximate=none)
                  (2): Dropout(p=0.0, inplace=False)
                  (3): Linear(in_features=3072, out_features=768, bias=True)
                  (4): Dropout(p=0.0, inplace=False)
                )
              )
            )
            (4): permuteo()
          )
        )
        (image_emb_head): NormAwareEmbedding(
          (projectors): ModuleDict(
            (feat_res4): Sequential(
              (0): Linear(in_features=384, out_features=1024, bias=True)
              (1): SafeBatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            )
            (feat_res5): Sequential(
              (0): Linear(in_features=768, out_features=1024, bias=True)
              (1): SafeBatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            )
          )
          (rescaler): None
        )
      )
      (fuser): QueryImageFuser(
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (reid_loss): OIMLossSafe()
    )
    (score_predictor): FastRCNNPredictor(
      (cls_score): Linear(in_features=768, out_features=1, bias=True)
      (bbox_pred): Linear(in_features=768, out_features=4, bias=True)
    )
  )
  (transform): GeneralizedRCNNTransform()
)